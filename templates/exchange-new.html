<!doctype html>
<html lang="en">
    <head>
        <title>SkillTree</title>
        {{ template "header" }}
        <!-- custom css -->
        <link rel="stylesheet" href="/static/main.css">
        <link rel="stylesheet" type="text/css" href="/static/font-awesome/css/font-awesome.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    </head>
    <body>
    	<div class="container">
            <div class="columns">
                {{ template "sidebar" .Page }}
                <main class="column col-10 col-gapless">
                	<div style="height:20vh;">
                		<ul class="step" style="padding-top:40px">
							<li class="step-item active">
							    <a href="#step1" class="tooltip" data-tooltip="Step 1">Step 1</a>
							</li>
							<li class="step-item">
							    <a href="#step2" class="tooltip" data-tooltip="Step 2">Step 2</a>
							</li>
							<li class="step-item">
							    <a href="#step3" class="tooltip" data-tooltip="Step 3">Step 3</a>
							</li>
							<li class="step-item">
							    <a href="#step4" class="tooltip" data-tooltip="Step 4">Step 4</a>
							</li>
						</ul>
                	</div>
                	<div id="exchange_step" style="height:80vh; overflow-y:scroll">
                		<div id="step1" class="each_exchange_step">
                        	<h2 class="step_title">
                                 {{ if $.En }}Choose your tree!!!{{ else }}選擇你的樹。{{end}}
                            </h2>
                            <!-- <h3 class="step_subtitle"></h3> -->
	                	{{ range $idx, $it := .MyTrees }}
							<div class="card column col-3 my_tree_card" data-tree_id="{{ $it.Treeid }}">
							    <div class="card-image">
							        {{ $it.Svg }}
							    </div>
							    <div class="card-header" data-tree_id="{{ $it.Treeid }}">
							        <div class="card-title h5">
							        {{ if $.Page.En }}{{ $it.Name }}{{ else }}{{ $it.Cname }}{{ end }}
							        </div>
							        <a href="#step2" class="btn btn-link exchange_button float-right new_exchange_mytree_button"  >
							        {{ if $.Page.En }}Choose{{ else }}選擇{{end}}
							    	</a>
							    </div>

							</div>
						{{ end }}
	                	</div>
	                	<div id="step2" class="each_exchange_step">
                            <h2 class="step_title">
                                 {{ if $.Page.En }}Choose the skill you have!!!{{ else }}選擇你想交換的技能。{{end}}
                            </h2>
                            <h3 class="step_subtitle"></h3>
                            <div class="select_skill">
                            </div>
	                	</div>
                        <div id="step3" class="each_exchange_step">
                            <h2 class="step_title">
                                 {{ if $.Page.En }}Choose the skill you want!!!{{ else }}選擇你想學習的技能{{end}}
                            </h2>
                            <h3 class="step_subtitle">
                                {{ if $.Page.En }} {{ $.TargetTree.Name }} {{ else }} {{ $.TargetTree.CName }} {{end}}
                                {{ $.TargetName }}
                            </h3>
                            <div class="select_skill">
                                {{ $.TargetTree.Svg }}
                            </div>
	                	</div>
                        <div id="step4" class="each_exchange_step">

	                	</div>
                	</div>



				</main>
            </div>
        </div>
        {{ template "footer" }}
    </body>
</html>

<script>

    //全域變數
    var new_exchange_data = [];

    $(document).ready(function(){
        // set_scroll_animate();
        set_step_active();
        set_selected_exchange_data();

        // $(".exchange_button").on("click", function(){
        //     tree_id = $(this).parent().attr("data-tree_id");
        //     console.log(tree_id);
        //     tree_chosen = tree_id;
        //
        // });

    });

    function set_scroll_animate() {

        //set scroll animate
        $(".step-item a, .each_exchange_step a").on('click', function(event){
            event.preventDefault();

            $('html, body').animate({
                scrollTop:$($.attr(this,'href')).offset().top
            }, 500);
        });
    }

    function set_step_active() {
        $(".step-item").on("click",function(){

            //Active the step item
            $(".step-item").removeClass("active");
            $(this).addClass("active");
        });
    }

    function set_selected_exchange_data() {

        //My tree
        $(".new_exchange_mytree_button").on("click", function(){

            // Add data to new_exchange_data
            // $(".new_exchange_mytree_button").removeClass("selected_new_exchange_mytree");
            // $(this).addClass("selected_new_exchange_mytree");
            new_exchange_data["mytree"] = $(this).parent().attr("data-tree_id");

            // Append svg tree to step 2
            // var my_tree_id = $(this).parent().attr("data-tree_id");
            $("#step2 .select_skill").empty();
            $("#step2 .select_skill").append($(this).parent().siblings(".card-image").html());
            $("#step2 h3").append($(this).siblings(".card-title").text());

            //Active the step item
            $(".step-item").removeClass("active");
            $(".step-item").eq(1).addClass("active");
        });



    }




</script>
